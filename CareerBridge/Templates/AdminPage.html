<html>
<head>
    <title>AdminPage</title>
    <style>
        #imageContainer {
        width: 500px;
        height: 500px;
        border: 1px solid #000;
    }
    img {
        width: 100%;
        height: 100%;
        display: none;
    }
    </style>
</head>
<body>
    <h1>AdminPage</h1>
    <h3 class="error">{{ error }}</h3>
    <h3 class="success">{{ success }}</h3>
    
    <div>
        <form action="{% url 'student_registration' %}" method="POST">
            {% csrf_token %}
            <h2>Student Registration</h2>
            FullName: <input type="text" name="SFullName" required> <br>
            RollNo: <input type="text" name="SRollNo" required> <br>
            Class: <select name="Class" id="">
                <option value="">--Select--</option>
                <option value="Class1">Class1</option>
                <option value="Class2">Class2</option>
                <option value="Class3">Class3</option>
                <option value="Class4">Class4</option>
                <option value="Class5">Class5</option>
            </select> <br>
            
            <button type="submit">Submit</button>
        </form>
    </div>
    <div>
        <form action="{% url 'TeacherRegistration' %}" method="POST">
            {% csrf_token %}
            <h2>Teacher Registration</h2>
            TeacherID : <input type="text" name="TeacherID" id="" required><br>
            FullName: <input type="text" name="TFullName" required> <br>
            MobileNo: <input type="text" name="TMobileNo" required> <br>
            Class Teacher: <select name="ClassTeacher" id="">
                <option value="">--Select--</option>
                <option value="Class1">Class1</option>
                <option value="Class2">Class2</option>
                <option value="Class3">Class3</option>
                <option value="Class4">Class4</option>
                <option value="Class5">Class5</option>
            </select> <br>
            <button type="submit">Submit</button>
        </form>
    </div>
    <div>
        <h1>Upload Image</h1>
        <form action="{%url 'UploadImage'%}" method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            <label for="Title">Title:</label>
            <input type="text" id="name" name="Title" required><br><br>
            <label for="Description">Description:</label>
            <input type="text" id="name" name="Description"><br><br>
            <label for="image">Image:</label>
            <input type="file" id="image" name="Image"><br><br>
            <button type="submit">Upload</button>
        </form>
    </div>
    
    <div>
        <h1>TimeTables</h1>
        <div id="imageContainer">
            {% for timetable in TimeTable %}
                <img id="{{ timetable.Class }}" src="{{ timetable.Image.url }}" alt="{{ timetable.Class }}" style="display: none;">
            {% endfor %}
        </div>
        {% for timetable in TimeTable %}
            <button onclick="showImage('{{ timetable.Class }}')">{{ timetable.Class }}</button>
            <a href="#" onclick="showChangeOption('{{ timetable.Class }}')">Change</a>
            <form id="form_{{ timetable.Class }}" action="{% url 'TimeTable' %}" method="POST" enctype="multipart/form-data" style="display: none;">
                {% csrf_token %}
                <input type="hidden" name="Class" value="{{ timetable.Class }}">
                <input type="file" name="TimeTable" accept="image/*">
                <button type="submit">Submit</button>
            </form>
        {% endfor %}
    </div>
    <div>
        <h2>Subjects</h2>
        <div id="subjectContainer">
            <table>
                <tr>
                    <th>Class</th>
                    <th>Subject Code</th>
                    <th>Subject Names</th>
                    <th>Action</th>
                </tr>
                {% for j in Subject %}
                <tr id="class_{{ j.Class }}" style="display: none;">
                    <td>{{ j.Class }}</td>
                    <td>{{ j.SubCode }}</td>
                    <td>{{ j.Subject }}</td>
                    <td>
                        <form action="{% url 'delete_subject' %}" method="POST" style="display:inline;">
                            {% csrf_token %}
                            <input type="hidden" name="subject_id" value="{{ j.id }}">
                            <button type="submit">Delete</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </table>
        </div>
        {% for i in Class %}
            <button onclick="showSubjects('{{ i }}')">{{ i }}</button>
        {% endfor %}
    
        <div id="addSubjectForm" style="display:none;">
            <h3>Add New Subject</h3>
            <form action="{% url 'add_subject' %}" method="POST">
                {% csrf_token %}
                <input type="hidden" name="Class" id="classInput">
                Subject Code: <input type="text" name="SubCode" required><br>
                Subject Name: <input type="text" name="Subject" required><br>
                <button type="submit">Add Subject</button>
            </form>
        </div>
    </div>
    
    <div>
        <form action="">
            <a href="{%url 'test'%}"><strong>LogOut</strong></a>
        </form>
    </div>

    <script>
        function validateForm() {
            const classSelect = document.getElementById("classSelect");
            if (classSelect.value === "") {
                alert("Please select a valid class.");
                return false; // Prevent form submission
            }
            return true; // Allow form submission
        }

        function showImage(imageId) {
            const images = document.querySelectorAll('#imageContainer img');
            images.forEach(img => img.style.display = 'none');
            
            const selectedImage = document.getElementById(imageId);
            selectedImage.style.display = 'block';
        }

        function showChangeOption(classId) {
            const form = document.getElementById(`form_${classId}`);
            form.style.display = 'block';
        }
        function showSubjects(classId) {
        // Hide all rows
        const rows = document.querySelectorAll('#subjectContainer table tr');
        rows.forEach(row => row.style.display = 'none');
        
        // Show header row
        if (rows.length > 0) {
            rows[0].style.display = 'table-row';
        }
        
        // Show relevant rows
        const selectedRows = document.querySelectorAll(`#class_${classId}`);
        selectedRows.forEach(row => row.style.display = 'table-row');
        
        // Update and show add subject form
        document.getElementById('classInput').value = classId;
        document.getElementById('addSubjectForm').style.display = 'block';
    }
    </script>
</body>
</html>
